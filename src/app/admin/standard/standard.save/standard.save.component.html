
<body>
<div class="container pt-5">
  <h1 class="mt-5">{{'criteria_registration' | translate}}</h1>
  <div class = "col-lg-7 col-md-offset-1 mb-5 mt-3">
    <mat-accordion>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Данные норматива
          </mat-panel-title>
        </mat-expansion-panel-header>

        <mat-form-field  class="w-100">
          <mat-label>Название норматива</mat-label>
          <input matInput  placeholder="Введите название" [formControl]="form.name"
                 [errorStateMatcher]="matcher">
          <mat-error *ngIf="form.name.hasError('required')">
            Обязательное поле
          </mat-error>
        </mat-form-field>

        <mat-form-field class="w-100">
          <mat-label>Версия норматива</mat-label>
          <input matInput placeholder="Введите версию" [formControl]="form.version"
                 [errorStateMatcher]="matcher">

          <mat-error *ngIf="form.name.hasError('required')">
            Обязательное поле
          </mat-error>
        </mat-form-field>

        <mat-form-field class="w-100">
          <mat-label>Описание норматива</mat-label>
          <input matInput placeholder="Введите описание" [formControl]="form.description"
                 [errorStateMatcher]="matcher">

          <mat-error *ngIf="form.description.hasError('required')">
            Обязательное поле
          </mat-error>
        </mat-form-field>
      </mat-expansion-panel>

      <h4 class="mt-3">Разделы</h4>
      <mat-divider class="mb-3"></mat-divider>
      <div *ngFor="let criteriaGroup of form.criteriaGroups, let cgIndex = index">
        <mat-expansion-panel class="mt-2">
          <mat-expansion-panel-header>
            <mat-panel-title>
              {{criteriaGroup.name.value || 'раздел без названия'}}
            </mat-panel-title>
          </mat-expansion-panel-header>
          <mat-form-field class="w-100">
            <mat-label>Название раздела</mat-label>
            <input matInput placeholder="Введите название" [formControl]="criteriaGroup.name"
                   [errorStateMatcher]="matcher">

            <mat-error *ngIf="criteriaGroup.name.hasError('required')">
              Обязательное поле
            </mat-error>
          </mat-form-field>
          <h4>Критерии </h4>
          <mat-divider class="mb-2"></mat-divider>
          <div *ngFor="let criterion of criteriaGroup.criteria, let cIndex = index">
            <mat-expansion-panel class="mt-2">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{criterion.name.value || 'критерий без названия'}}
                </mat-panel-title>
              </mat-expansion-panel-header>

              <mat-form-field class="w-100">
                <mat-label>Название критерии</mat-label>
                <input matInput placeholder="Введите название" [formControl]="criterion.name"
                       [errorStateMatcher]="matcher">

                <mat-error *ngIf="criterion.name.hasError('required')">
                  Обязательное поле
                </mat-error>
              </mat-form-field>

              <mat-form-field class="w-100">
                <mat-label>Описание</mat-label>
                <input matInput placeholder="Введите описание" [formControl]="criterion.description"
                       [errorStateMatcher]="matcher">

                <mat-error *ngIf="criterion.description.hasError('required')">
                  Обязательное поле
                </mat-error>
              </mat-form-field>

              <mat-form-field class="w-100">
                <mat-label>Значение</mat-label>
                <input matInput type="number" placeholder="Введите значение" [formControl]="criterion.value"
                       [errorStateMatcher]="matcher">

                <mat-error *ngIf="criterion.value.hasError('required')">
                  Обязательное поле
                </mat-error>
              </mat-form-field>

              <mat-card-actions>
                <button mat-button (click)="onCriterionRemove(cgIndex, cIndex)">Удалить критерий</button>
              </mat-card-actions>
            </mat-expansion-panel>
          </div>
          <button mat-stroked-button color="primary" class="mt-3 mat-small" (click)="onCriterionAdd(cgIndex)">+ Добавить критерий</button>
          <mat-divider class="mt-3"></mat-divider>
          <mat-card-actions>
            <button mat-button (click)="onCriteriaGroupRemove(cgIndex)">Удалить раздел</button>
          </mat-card-actions>
        </mat-expansion-panel>

      </div>

    </mat-accordion>
    <button mat-stroked-button color="primary" class="mt-3 mat-small" (click)="onCriteriaGroupAdd()">+ Добавить раздел</button>
    <mat-divider class="mt-3"></mat-divider>
    <button mat-raised-button color="primary" class="mt-3 mat-small" (click)="onSave()">Сохранить</button>
    <button mat-stroked-button color="primary" class="mt-3 ms-2 mat-small" (click)="onCancel()">Отмена</button>
  </div>
  <br>
</div>
</body>

